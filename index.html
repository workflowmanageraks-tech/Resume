<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bookmark Manager</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f6f9;
    padding:20px;
    transition:0.3s;
}
body.dark{
    background:#121212;
    color:#eee;
}
.container{
    max-width:720px;
    margin:auto;
    background:#fff;
    padding:20px;
    border-radius:10px;
}
body.dark .container{
    background:#1e1e1e;
}
input, select{
    width:100%;
    padding:8px;
    margin:6px 0;
}
button{
    padding:8px 12px;
    margin:5px 5px 5px 0;
    cursor:pointer;
}
.bookmark{
    background:#eef;
    padding:10px;
    margin-top:10px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    border-left:5px solid #667eea;
}
body.dark .bookmark{
    background:#2a2a2a;
}
a{font-weight:bold;}
hr{margin:15px 0;}
.small{font-size:12px;color:#666;}
</style>
</head>

<body>

<div class="container">
<h2>Bookmark Manager</h2>

<button onclick="toggleDark()">Dark Mode</button>

<!-- FILTER -->
<select id="filter" onchange="render()"></select>

<hr>

<!-- ADD BOOKMARK -->
<input id="name" placeholder="Website Name">
<input id="url" placeholder="Website URL">

<select id="label"></select>

<!-- ADD NEW LABEL -->
<input id="newLabel" placeholder="Add new label (optional)">
<button onclick="addLabel()">Add Label</button>

<button onclick="saveBookmark()">Add / Update Bookmark</button>

<hr>

<button onclick="exportTxt()">Export</button>
<input type="file" accept=".txt" onchange="importTxt(event)">

<div id="list"></div>
</div>

<script>
let bookmarks = JSON.parse(localStorage.getItem("bookmarks")) || [];
let labels = JSON.parse(localStorage.getItem("labels")) || ["Everyone","Alone"];
let editIndex = -1;

/* INIT */
function init(){
    updateLabelDropdowns();
    render();
}
init();

/* Dark Mode */
function toggleDark(){
    document.body.classList.toggle("dark");
}

/* Update Label dropdowns */
function updateLabelDropdowns(){
    const labelSelect = document.getElementById("label");
    const filterSelect = document.getElementById("filter");

    labelSelect.innerHTML="";
    filterSelect.innerHTML="<option value='All'>Show All</option>";

    labels.forEach(l=>{
        labelSelect.innerHTML += `<option value="${l}">${l}</option>`;
        filterSelect.innerHTML += `<option value="${l}">${l}</option>`;
    });

    localStorage.setItem("labels", JSON.stringify(labels));
}

/* Add new label */
function addLabel(){
    const newLabel = document.getElementById("newLabel").value.trim();
    if(!newLabel) return alert("Enter label name");
    if(labels.includes(newLabel)) return alert("Label already exists");

    labels.push(newLabel);
    document.getElementById("newLabel").value="";
    updateLabelDropdowns();
    alert("Label added");
}

/* Save Bookmark */
function saveBookmark(){
    const name = document.getElementById("name").value.trim();
    const url = document.getElementById("url").value.trim();
    const label = document.getElementById("label").value;

    if(!name || !url){
        alert("Name & URL required");
        return;
    }

    const data = {name,url,label};

    if(editIndex === -1){
        bookmarks.push(data);
    }else{
        bookmarks[editIndex] = data;
        editIndex = -1;
    }

    localStorage.setItem("bookmarks", JSON.stringify(bookmarks));
    clearInputs();
    render();
}

/* Clear inputs */
function clearInputs(){
    name.value="";
    url.value="";
    label.selectedIndex=0;
}

/* Render with filter */
function render(){
    const list = document.getElementById("list");
    const filter = document.getElementById("filter").value;
    list.innerHTML="";

    bookmarks.forEach((b,i)=>{
        if(filter !== "All" && b.label !== filter) return;

        const div = document.createElement("div");
        div.className="bookmark";
        div.innerHTML=`
            <div>
                <a href="${b.url}" target="_blank">${b.name}</a><br>
                <span class="small">Label: ${b.label}</span>
            </div>
            <div>
                <button onclick="editBookmark(${i})">Edit</button>
                <button onclick="deleteBookmark(${i})">Delete</button>
            </div>
        `;
        list.appendChild(div);
    });
}

/* Edit */
function editBookmark(i){
    name.value = bookmarks[i].name;
    url.value = bookmarks[i].url;
    label.value = bookmarks[i].label;
    editIndex = i;
}

/* Delete */
function deleteBookmark(i){
    if(confirm("Delete bookmark?")){
        bookmarks.splice(i,1);
        localStorage.setItem("bookmarks", JSON.stringify(bookmarks));
        render();
    }
}

/* Export */
function exportTxt(){
    if(bookmarks.length===0) return alert("No data");
    const text = bookmarks.map(b=>`${b.name}|${b.url}|${b.label}`).join("\n");
    const blob = new Blob([text],{type:"text/plain"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download="bookmarks.txt";
    a.click();
}

/* Import */
function importTxt(e){
    const file = e.target.files[0];
    if(!file) return;

    const reader = new FileReader();
    reader.onload = ()=>{
        reader.result.split("\n").forEach(line=>{
            const [name,url,label] = line.split("|");
            if(name && url){
                if(label && !labels.includes(label)) labels.push(label);
                bookmarks.push({
                    name:name.trim(),
                    url:url.trim(),
                    label:label?.trim() || "Everyone"
                });
            }
        });
        localStorage.setItem("bookmarks", JSON.stringify(bookmarks));
        updateLabelDropdowns();
        render();
    };
    reader.readAsText(file);
}
</script>

</body>
</html>
